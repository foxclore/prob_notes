% !TEX root = ../main.tex

\section{Незалежні випробування. Схема Бернуллі.}
\subsection{Поліноміальна схема}
Припустимо, що події $A_1, A_2, ..., A_k$ утворюють повну групу подій деякого 
СЕ, причому відомі ймовірності $\P(A_i) = p_i, \sum\limits_{i=1}^k p_i = 1$.
Експеримент проводиться $n$ разів, в кожному з яких може відбутись одна з 
подій $A_i$. Можливими результатами $n$ раз проведеного експерименту будуть події
$A_{i_1}^{(1)} \cap A_{i_2}^{(2)} \cap ... \cap A_{i_n}^{(n)}$,
де $A_{i_r}^{(r)}, r = 1,...,n, i_r = 1, ..., k$ --- один із можливих результатів $r$-того випробування.
\begin{definition}\index{незалежні випробування}
    Випробування, що проводяться, називаються \emph{незалежними}, якщо 
    $$\P\left(A_{i_1}^{(1)} \cap A_{i_2}^{(2)} \cap ... \cap A_{i_n}^{(n)}\right) = 
    \P\left(A_{i_1}^{(1)}\right) \cdot \P\left(A_{i_2}^{(2)}\right) \cdot ... \cdot \P\left(A_{i_n}^{(n)}\right)$$
\end{definition}
Прикладами незалежних випробувань є багаторазове підкидання монети або грального кубика,
проведення декількох тиражів лотереї з незмінними правилами тощо.

Основна задача --- знайти ймовірність того, що подія $A_1$ відбудеться $m_1$ разів, 
подія $A_2$ відбудеться $m_2$ разів і т.д., подія $A_k$ відбудеться $m_k$ разів, причому $\sum\limits_{j=1}^k m_j = n$. Такі ймовірності будемо позначати як $\P_n(m_1, m_2, ..., m_k)$.
Одним з можливих варіантів послідовності появи цих подій є поява події $A_1$ у перших $m_1$ випробуваннях,
$A_2$ --- у наступних $m_2$ і так далі, $a_k$ у останніх $m_k$. Знайдемо відповідну ймовірність:
$$\P\left(\underbrace{A_1 \cap ... \cap A_1}_{\text{перші }m_1} 
\cap \underbrace{ A_2 \cap ... \cap A_2}_{\text{наступні }m_2}
\cap ... \cap  \underbrace{A_k \cap ... \cap A_k}_{\text{останні }m_k}\right)
= p_1^{m_1} p_2^{m_2} ... p_k^{m_k}$$

Це є лише один із можливих варіантів послідовності появи подій в серії випробувань. Всього таких варіантів 
рівно $C_n^{m_1, m_2, ..., m_k} = \frac{n!}{m_1!m_2! ... m_k!}$. Таким чином отримуємо:
\begin{equation}\label{eq:poly_prob}
    \P_n(m_1, ..., m_k) = \frac{n!}{m_1!m_2! ... m_k!} p_1^{m_1} p_2^{m_2} ... p_k^{m_k}
\end{equation}
\begin{definition}\index{схема ймовірності!поліноміальна}
    Ймовірності, що обчислюємо за формулою \eqref{eq:poly_prob}, називаються \emph{поліноміальними}, а 
    сама схема --- \emph{поліноміальною схемою ймовірності}. 
\end{definition}
\begin{remark} Назва <<поліноміальна>> пов'язана з тим, що $\frac{n!}{m_1!m_2! ... m_k!}$
    є коефіцієнтом при $p_1^{m_1} p_2^{m_2} ... p_k^{m_k}$ в розкладі полінома $(p_1 + p_2 + ... + p_k)^n$.
    Звідси ж можна отримати, що
    $$1 = (p_1 + p_2 + ... + p_k)^n = \sum\limits_{m_1 + ... + m_k = n} \P_n(m_1, ..., m_k)$$
\end{remark}
\begin{example}
    Студент ІПСА за рівнем підготовки з ймовірністю $0.3$ вважається слабким студентом, 
    з ймовірністю $0.5$ вважається середнім студентом та 
    з ймовірністю $0.2$ --- сильним студентом. Яка ймовірність того, що з 6 навмання 
    обраних студентів кількість слабких та сильних буде однаковою?

    Розглядаємо подію $A = \left\{\text{кількість слабких рівна кількості сильних}\right\}$. 
    Позначимо ймовірності того, що студент має певний рівень підготовки, таким чином:
    $p_1 = 0.3$, $p_2 = 0.5$, $p_3 = 0.2$.
    Треба знайти $\P(A)$.
    Скористаємось поліноміальною схемою:
    $\P(A) = \P_6(3, 0, 3) + \P_6(2, 2, 2) + \P_6(1, 4, 1) + \P_6(0, 6, 0) = 
    \frac{6!}{3!3!}\cdot(0.3)^3 \cdot(0.2)^3 + \frac{6!}{2!2!2!}\cdot(0.3)^2 \cdot(0.5)^2 \cdot(0.2)^2 + 
    \frac{6!}{1!4!1!}\cdot0.3 \cdot(0.5)^4 \cdot 0.2 + \frac{6!}{6!} \cdot(0.5)^6 = 0.213445$.
\end{example}
\subsection{Схема Бернуллі}
\begin{definition}\index{схема ймовірності!біноміальна (Бернуллі)}
    Поліноміальна схема, в кожному випробуванні якої є тільки дві події $A_1$ та $A_2$, 
    називається \emph{біноміальною схемою} або \emph{схемою Бернуллі}.
\end{definition}

Якщо $A_1$ та $A_2$ утворюють повну групу подій, то $A_2 = \overline{A_1}$.
Позначимо $A_1 = A$ --- <<успіх>>, $A_2 = \overline{A}$ --- <<невдача>>, 
$\P(A) = p$, $\P(\overline{A}) = 1-p = q$.

Яка ймовірність того, що в $n$ випробуваннях <<успіх>> з'явиться $m$ разів?
На це питання дає відповідь \emph{формула Бернуллі}, яку можна отримати з \eqref{eq:poly_prob}:
\index{формула!Бернуллі}
\begin{equation}\label{eq:bern_prob}
    \P_n(m) = \frac{n!}{m!(n-m)!}p^mq^{n-m} = 
    C_n^m p^m q^{n-m}
\end{equation}
Ймовірності, що обчислюються за цією формулою, називаються \emph{біноміальними}.

\begin{example}\label{ex:sportsman}
    Спортсмен 5 разів стріляє по мішені. Ймовірність влучення при кожному пострілі --- 0.2. 
    Яка ймовірність того, що він влучив не менше 3 разів?

    $\P\left\{\text{влучив} \geq  \text{3 разів} \right\} = \P_5(3) + \P_5(4) + \P_5(5) = 
    C_5^3 (0.2)^3 (0.8)^2 + C_5^4 (0.2)^4 0.8 + C_5^5 (0.2)^5 = 0.05792$.
\end{example}
\subsection{Найбільш імовірна кількість успіхів в схемі Бернуллі}
\begin{definition}
    Натуральне число $m_0$, при якому $\P_n(m)$ набуває найбільшого значення, 
    називається \emph{найбільш імовірною кількістю успіхів}.
\end{definition}

Знайдемо $m_0$:
$$\begin{cases}
    \P_n(m_0 - 1) \leq \P_n(m_0)\\
    \P_n(m_0 + 1) \leq \P_n(m_0)
\end{cases}
\Leftrightarrow 
\begin{cases}
    \frac{n!}{(m_0 - 1)!(n-m_0+1)!} p^{m_0 - 1} q^{n - m_0 + 1} 
    \leq 
    \frac{n!}{m_0!(n-m_0)!} p^{m_0} q^{n - m_0}\\
    \frac{n!}{(m_0 + 1)!(n-m_0-1)!} p^{m_0 + 1} q^{n - m_0 - 1} 
    \leq 
    \frac{n!}{m_0!(n-m_0)!} p^{m_0} q^{n - m_0}
\end{cases}
\Leftrightarrow
$$

$$
\Leftrightarrow
\begin{cases}
    \frac{q}{n-m_0+1} \leq \frac{p}{m_0} \\
    \frac{p}{m_0 + 1} \leq \frac{q}{n-m_0}
\end{cases}
\Leftrightarrow
\begin{cases}
    m_0 \leq np+p\\
    m_0 \geq np-q
\end{cases}
$$
\hbox to \hsize{\hfil{
    \begin{tikzpicture}[scale = 0.8]
        \node [below] at (2, 0) {$np-q$};
        \node [below] at (6, 0) {$np+p$};
        \draw [fill] (4, 0) circle [radius = 0.08];
        \draw [fill] (2, 0) circle [radius = 0.05];
        \draw [fill] (6, 0) circle [radius = 0.05];
        \node [below] at (4, 0) {$m_0$};
        \draw [-{Straight Barb}] [thick] (0, 0) -- (8, 0);
        \draw [thick] (2, 0) to (2, 0.5);
        \draw [thick] (6, 0) to (6, 0.5);
        \draw [{Straight Barb}-{Straight Barb}] [thick] (2, 0.5) to (6, 0.5);
        \node [above] at (4, 0.5) {1};
    \end{tikzpicture}
}\hfil}

Таким чином, отримуємо два варіанти:
\begin{enumerate}
    \item Якщо $np+p$ не ціле, то $m_0 = \left[np+p\right]$.
    \item Якщо $np+p$ ціле, то існують два найбільш ймовірних числа $m_0^{(1)} = np+p$ та $m_0^{(2)} = np-q$.
\end{enumerate}

\begin{example}
    Знайти найбільш імовірну кількість успіхів для попереднього \hyperref[ex:sportsman]{прикладу}.

    Оскільки $np + p = 1.2$, то $m_0 = \left[np + p\right] = \left[1.2\right] = 1$.
    Ймовірність лише одного влучення буде найбільшою, рівною $0.904$.
\end{example}

\subsection{Асимптотичні наближення формули Бернуллі}
Формула Бернуллі не є зручною для великих значень $m$ та $n$ через складність обчислень, особливо для малих значень ймовірності успіху $p$. Існують формули, якими можна 
скористатись для наближення результатів формули Бернуллі.
\begin{proposition*}[асимптотична формула Пуассона]\index{формула!Пуассона, асимптотична}
    Нехай $n$ --- достатньо велике натуральне число, а p --- достатньо мале, щоб 
    $a = np \in (1, 20)$. Тоді для наближення формули Бернуллі можна використати 
    асимптотичну формулу Пуассона:
    \begin{equation}\label{eq:poiss_aprox}
        \P_n(m) \approx \frac{(np)^m}{m!}e^{-np}
    \end{equation}
\end{proposition*}
\begin{proof}[Доведення (нестроге)] Розпишемо $\P_n(m)$:
    \begin{gather*}
        \P_n(m) = C_n^m p^m (1-p)^{n-m} = \frac{n(n-1)...(n-m+1)}{m!} \left(\frac{a}{n}\right)^m 
        \left(1-\frac{a}{n}\right)^{n-m} = \\
        \frac{a^m}{m!}\cdot 1 \left(1 - \frac{1}{n}\right)\left(1 - \frac{2}{n}\right)
        ...\left(1 - \frac{m+1}{n}\right)\left(1-\frac{a}{n}\right)^n \left(1-\frac{a}{n}\right)^{-m} 
        \to \frac{a^m}{m!}e^{-a} n\to\infty
    \end{gather*}
    Отже, ця наближена рівність є наслідком існування границі $\P_n(m)$ при $n\to\infty$. 
\end{proof}
\begin{proposition*}[формула Муавра-Лапласа]\index{формула!Муавра-Лапласа, асимптотична}
    Нехай $npq \geq 20$. Тоді для наближення формули Бернуллі можна використати 
    формулу Муавра-Лапласа:
    \begin{equation}\label{eq:laplace_approx}
        \P_n(m) \approx \frac{1}{\sqrt{2\pi npq}} e^{-\frac{(m-np)^2}{2npq}}
    \end{equation}
\end{proposition*}
Детальне доведення та пояснення обох тверджень буде в темі <<Граничні теореми теорії ймовірностей>> (ст. \pageref{binom_theorems}).

\begin{example}
    \begin{enumerate}
        \item Словник має 1500 сторінок. Ймовірність друкарської помилки на одній сторінці дорівнює
        0.001. Знайти ймовірність того, що в словнику буде рівно 3 помилки.

        За умовою $p=0.001$, $n=1500$, тому $np = 1.5$ і можна застосувати формулу Пуассона \eqref{eq:poiss_aprox}:
        $\P_{1500}(3) \approx \frac{1.5^3}{3!} e^{-1.5} \approx 0.12551$.
        Якщо ж скористатися точною формулою \eqref{eq:bern_prob}, отримаємо
        $\P_{1500}(3) \approx 0.12554$.
        \item Завод у середньому виготовляє 80\% виробів першого сорту та 20\% --- другого.
        Знайти ймовірність того, що серед 400 навмання відібраних виробів, які виготовлені на цьому заводі,
        84 вироби будуть другого сорту.

        За умовою $n=400$, $m=84$, $p=0.2$, $q=0.8$, тому $npq = 64$ і можна застосувати формулу Муавра-Лапласа \eqref{eq:laplace_approx}:
        $\P_{400}(84) \approx \frac{1}{\sqrt{2\pi \cdot 64}} \cdot \exp\left\{
            -\frac{(84 - 400\cdot0.2)^2}{2\cdot 64} \approx 0.044
        \right\}$. Якщо ж скористатися точною формулою \eqref{eq:bern_prob}, отримаємо
        $\P_{400}(84) \approx 0.04323$. Зауважимо, що застосування в цьому випадку формули Пуассона \eqref{eq:poiss_aprox}
        дало б відповідь, далеку від правильної: приблизно $0.0394$.
    \end{enumerate}
\end{example}