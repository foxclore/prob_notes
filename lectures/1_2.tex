% !TEX root = ../main.tex

\newlength\Radius
\setlength\Radius{2cm}

\section{Аксіоми теорії ймовірностей}
Розглянуті ймовірнісні схеми (класична, геометрична) мають свої недоліки і не дають можливості описати різноманіття стохастичних експериментів.
Сучасна теорія ймовірностей побудована на основі аксіом, які були запропоновані академіком 
\href{https://uk.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BB%D0%BC%D0%BE%D0%B3%D0%BE%D1%80%D0%BE%D0%B2_%D0%90%D0%BD%D0%B4%D1%80%D1%96%D0%B9_%D0%9C%D0%B8%D0%BA%D0%BE%D0%BB%D0%B0%D0%B9%D0%BE%D0%B2%D0%B8%D1%87}{Андрієм Миколайовичем Колмогоровим} у 1929 році.
Класична та геометрична схеми виявляються частинними випадками цього аксіоматичного підходу.

\subsection{Система аксіом Колмогорова}\index{система аксіом Колмогорова}
\begin{enumerate}[label=\Roman*.]
    \item Побудова вимірного простору $\left\{ \Omega, \mathcal{F}\right\}$:
    \begin{enumerate}[label = \textbf{A\arabic*:}]
        \item Будь-якому стохастичному експерименту можна поставити у відповідність
        простір елементарних подій $\Omega$.\index{подія!простір елементраних подій}
        \item $\left(\forall n \in \mathbb{N}: A_n \in \mathcal{F} \right) \Rightarrow \left( \bigcup\limits_{n=1}^{n (\infty)} A_n \in \mathcal{F}\right)$.
        \item $\left( A \in \mathcal{F}\right) \Rightarrow \left( \overline{A} \in \mathcal{F}\right)$.
        
        Дві останні аксіоми стосуються побудови алгебри чи $\sigma$-алгебри подій.
    \end{enumerate}
    \item Властивості ймовірності:
    \begin{enumerate}[label = \textbf{P\arabic*:}]
        \item $\forall A \in \mathcal{F}: \P(A)\geq 0$.
        \item $\P(\Omega) = 1$ --- аксіома нормування. \index{аксіома!нормування}
        \item $\forall A_1, A_2, ..., A_n, ... \in \mathcal{F},  A_i \cap A_j = \varnothing \text{ при } i \neq j: \P\left(\bigcup\limits_{n=1}^{\infty} A_n\right) = \sum\limits_{n=1}^{\infty} \P(A_n)$ ---
        аксіома зліченної адитивності. \index{аксіома!зліченної адитивності}
        Іноді, у випадках <<простої>> алгебри (а не $\sigma$-алгебри), достатньо
        аксіоми скінченної адитивності \textbf{P3$'$}: \index{аксіома!скінченної адитивності}
        $\forall A_1, A_2, ..., A_n \in \mathcal{F},  A_i \cap A_j  = \varnothing \text{ при } i \neq j: \P\left(\bigcup\limits_{k=1}^{n} A_k\right) = \sum\limits_{k=1}^{n} \P(A_k)$.
    \end{enumerate}
\end{enumerate}
\begin{definition}\index{ймовірність}
    Нормована міра $\P$, що введена на вимірному просторі $\left\{ \Omega, \mathcal{F}\right\}$,
    називається \emph{ймовірністю}. Всі події беруться з $\sigma$-алгебри подій.
    Трійка $\left\{ \Omega, \mathcal{F}, \P\right\}$ називається 
    \emph{ймовірнісним простором} стохастичного експерименту.
\end{definition}

Ця система аксіом несуперечна, бо існують стохастичні експерименти,
які задовольняють цим аксіомам, але неповна, бо в різних задачах
теорії ймовірностей розглядаються різні ймовірнісні простори.

\begin{example}
    Стохастичний експеримент полягає в киданні монети до першої появи герба. Введемо елементарні події $\omega_k = \left\{ 
        \text{герб випав при } k \text{-тому киданні}
    \right\}$. Простором простір елементарних подій буде зліченною множиною:
    $\Omega = \left\{\omega_k : k \in \mathbb{N} \right\}$. В якості $\sigma$-алгебри $\mathcal{F}$ візьмемо множину всіх підмножин $\Omega$.
    Оскільки ймовірність випадіння герба на <<чесній>> монеті рівна $\frac{1}{2}$ (як і ймовірність того, що герб не випаде), то логічно кожній елементарній події $\omega_k$ поставити 
    у відповідність число $p_k = \frac{1}{2^k}$. Також, для всіх $A \subset \Omega$ (або ж, в цьому випадку еквівалентно, $A \in \mathcal{F}$) покладемо
    $\P(A) = \sum\limits_{\omega_k \in A} p_k$.
\end{example}

\begin{exercise}
    Перевірити виконання усіх аксіом для цього прикладу, а також для класичної моделі ймовірності.
\end{exercise}

\begin{remark}
    Не завжди в якості $\sigma$-алгебри $\mathcal{F}$ можна обрати множину всіх підмножин $\Omega$. 
    У випадку класичної моделі ймовірності та у розглянутому вище прикладі
    це можна зробити, тому що, в деякому сенсі, $2^{\Omega}$ містить <<небагато>> подій: множина всіх підмножин скінченної множини також
    є скінченною, а множина всіх підмножин зліченною множини має потужність континууму (таку ж, як відрізок $[0; 1]$).
    У тому випадку, коли вже сам простір $\Omega$ має потужність континууму (як у випадку геометричної моделі ймовірності),
    множина всіх його підмножин має потужність, більшу за континуум, тому, в деякому сенсі, цих підмножин стає <<дуже багато>>.
    Для стохастичного експерименту, який полягає у киданні навмання точки на відрізок $[0; 1]$,
    можна навести \href{https://uk.wikipedia.org/wiki/%D0%9C%D0%BD%D0%BE%D0%B6%D0%B8%D0%BD%D0%B0_%D0%92%D1%96%D1%82%D0%B0%D0%BB%D1%96}{конкретний приклад}
    побудови підмножини $[0; 1]$, якій не можна надати \emph{жодного} значення ймовірності, навіть нульового.
    І хоча цей приклад виходить за рамки курсу, варто зауважити, що наводиться лише доведення того, що така множина існує:
    алгоритм побудови спирається на вибір елементів з незліченної множини, тому не може бути реалізований на будь-якому обчислювальному пристрої
    (можливість такого вибору ґрунтується на так званій <<аксіомі вибору>> з теорії множин).
    Через це для незліченних $\Omega$ в якості $\mathcal{F}$ треба розглядати такі набори підмножин, які все ще будуть досить великими,
    щоб включати в себе якомога більше подій, знання ймовірності яких може знадобитися, але не настільки великими, щоб це унеможливлювало введення ймовірності взагалі.
\end{remark}

\subsection{Властивості ймовірності, що випливають з аксіом}
\begin{enumerate}
    \item Якщо $A_1, A_2, ..., A_n, ... \in \mathcal{F}$ утворюють повну групу 
    подій, то $\P\left(\bigcup\limits_{k=1}^\infty A_k\right) = 1$.
    \begin{proof}
        Випливає з аксіоми \textbf{P2}.
    \end{proof}
    \item $\P(\overline{A}) = 1 - \P(A)$.
    \begin{proof}
        $A \cup \overline{A} = \Omega \Rightarrow 1 \overset{\text{\textbf{P2}}}{=} \P(\Omega) 
        = \P(A \cup \overline{A}) \overset{\text{\textbf{P3}}'}{=} \P(A) + \P(\overline{A})$.
    \end{proof}
    \item $\P(\varnothing) = 0$.
    \begin{proof}
        Наслідок із властивості 2 $(\varnothing = \overline{\Omega})$.
    \end{proof}
    \suspend{enumerate}
    \begin{remark}
        Якщо ймовірність події дорівнює нулю, то це не означає, що подія неможлива. Наприклад,
        якщо СЕ --- кидання точки на відрізок $[a; b]$, а подія $A$ полягає в тому, що точка потрапила в 
        певну точку $x \in [a; b]$, то $A$ не є неможливою, проте $\P(A) = 0$.
    \end{remark}
    \resume{enumerate}
    \item $A \subset B \Rightarrow \P(A) \leq \P(B)$.
    \begin{proof}
        $A \subset B \Rightarrow B = A \cup (B \setminus A) 
        \overset{\text{\textbf{P3}}'}{\Rightarrow} \P(B) = \P(A) + \P(B \setminus A) 
        \overset{\text{\textbf{P1}}}{\geq} \P(A)$.
    \end{proof}
    \item $\forall A \in \mathcal{F}: \P(A) \leq 1$.
    \begin{proof}
        Наслідок з властивості 4, $A \subset \Omega$ та \textbf{P2}.
    \end{proof}
    \item $A \subset B: \P(B \setminus A) = \P(B) - \P(A)$.
    \begin{proof}
        Наслідок з доведення властивості 4.
    \end{proof}
    \item $\forall A, B \in \mathcal{F}: \P(A \cup B) = \P(A) + \P(B) - \P(A \cap B)$.
    \begin{proof}
        $A \cup B = (A\setminus(A \cap B)) 
        \cup (A \cap B) 
        \cup (B\setminus(A \cap B))$ --- попарно несумісні події. 
        \newline
        З аксіоми \textbf{P3$'$}: $\P(A \cup B) = \P(A\setminus(A \cap B)) 
        + \P(A \cap B) + \P(B\setminus(A \cap B)) \overset{6}{=} \P(A) - \P(A \cap B) + \P(A \cap B)
        + \P(B) - \P(A \cap B) = \P(A) + \P(B) - \P(A \cap B)$.
    \end{proof}
    \item Узагальнення властивості 7 --- формула включення-виключення для ймовірностей: 
    
    \begin{math}
        \forall A_1, A_2, \dots, A_n \in \mathcal{F} 
    : \P\left(\bigcup\limits_{i=1}^n A_i\right) = \sum\limits_{i=1}^n \P(A_i) - \sum\limits_{i < j}^n \P(A_i \cap A_j)
    + \sum\limits_{i < j < k}^n \P(A_i \cap A_j \cap A_k) - ... + (-1)^{n-1}\P\left(\bigcap\limits_{i=1}^n A_i\right)
    \end{math}.
    \nopagebreak
    \suspend{enumerate}
    \begin{exercise}
        Довести властивість 8.
    \end{exercise}

\begin{example}[задача про неуважну секретарку]\index{задача!про неуважну секретарку}
    Секретарка поклала $n$ листів в $n$ чистих конвертів, заклеїла ці конверти і тільки 
    після цього написала адреси. Яка ймовірність того, що хоча б один з листів дійде 
    за призначенням?
    
    Введемо події
    $A_i = \left\{i\text{-тий лист дійшов за призначенням}\right\}, i = 
    1,...,n. \;\P(A_i) = \frac{1}{n} = \frac{(n-1)!}{n!}$.
    Тоді шукана подія
    $A = \left\{\text{хоча б один із листів дійшов за призначенням}\right\} = \bigcup\limits_{i=1}^n A_i$.
    Для застосування формули включення-виключення треба знайти відповідні ймовірності перетинів подій:
    $\P(A_i \cap A_j) = \frac{(n-2)!}{n!} = \frac{1}{n(n-1)}, i \neq j$,
    $\P(A_i \cap A_j \cap A_k) = \frac{1}{n(n-1)(n-2)}, i \neq j \neq k$, і так далі,
    $\P(A_1 \cap ... \cap A_n) = \frac{1}{n!}$. Формула для обчислення ймовірності перетину деяких $k$ подій --- це частка
    тих перестановок множини $\left\{1,...,n\right\}$ (тобто, усіх можливих варіантів того, куди можуть потрапити листи),
    в яких відповідні $k$ листів доходять за призначенням, а інші --- довільним чином. Зрозуміло, що усього варіантів
    обрати ці $k$ листів --- $C_n^k$. Тому отримуємо
    $\P(A) = n\cdot \frac{1}{n} - C_n^2 \cdot \frac{1}{n(n-1)}- \dots + (-1)^{n-1}\frac{1}{n!}
    = 1 - \frac{1}{2!} + \frac{1}{3!} - \dots +(-1)^{n-1} \cdot \frac{1}{n!} \approx 
    1 - e^{-1} \approx 0.63$.
\end{example}
\resume{enumerate}
    \item $\forall A_1, A_2, ..., A_n, ... \in \mathcal{F}: 
    \P\left(\bigcup\limits_{k=1}^\infty A_k\right) \leq \sum\limits_{k=1}^\infty \P(A_k)$
    \begin{proof}
        Введемо події $B_1 = A_1, B_2 = \overline{A_1} \cap A_2, 
        B_3 = \overline{A_1} \cap \overline{A_2} \cap A_3, ..., B_n = 
        \overline{A_1} \cap \overline{A_2} \cap ...$ 
        \newline
        $... \cap \overline{A_{n-1}} \cap A_n, ...$. Ці події попарно несумісні, 
        $\bigcup\limits_{k=1}^\infty B_k = \bigcup\limits_{k=1}^\infty A_k,\;B_k \subset A_k $ для всіх $k \in \mathbb{N}$.
        \newline
        $\P\left(\bigcup\limits_{k=1}^\infty A_k\right) = \P\left(\bigcup\limits_{k=1}^\infty B_k\right) 
        \overset{P3}{=} \sum\limits_{k=1}^\infty \P(B_k) \overset{4}{\leq} 
        \sum\limits_{k=1}^\infty \P(A_k)$.
    \end{proof}
    \item $\forall A_1, A_2, ..., A_n, ... \in \mathcal{F}: \P\left(\bigcap\limits_{k=1}^\infty
    A_k\right) = 1 - \P\left(\overline{\bigcap\limits_{k=1}^\infty A_k}\right) = 1 - \P\left(\bigcup\limits_{k=1}^\infty \overline{A_k}\right) \geq  
    1 - \sum\limits_{k=1}^\infty \P(\overline{A_k})$.
\end{enumerate}

\subsection{Теореми неперервності ймовірності}
\index{теорема!неперервності}
\begin{theorem}\label{th:1}
    Нехай є монотонно неспадна послідовність подій $A_1 \subset A_2 \subset ... \subset A_n ... \in \mathcal{F}$.
    Тоді $\P\left(\bigcup\limits_{n=1}^{\infty} A_n\right) = \lim\limits_{n\rightarrow \infty} \P(A_n)$.
\end{theorem}
\begin{proof}
    Зважаючи на монотонну неспадність послідовності, можна записати $\bigcup\limits_{n=1}^{\infty} A_n = A_1 \cup (A_2 \setminus A_1) \cup (A_3 \setminus A_2) \cup ... \cup (A_{n} \setminus A_{n-1}) \cup ... =
    A_1 \cup \left(\bigcup\limits_{n=1}^{\infty} (A_n \setminus A_{n-1})\right)$, причому $A_1$ та усі $A_n \setminus A_{n-1}$ є попарно несумісними.
    Тоді з аксіоми \textbf{P3}: $\P\left(\bigcup\limits_{n=1}^{\infty} A_n\right) = \P(A_1) + \sum\limits_{n=2}^{\infty} \P(A_{n} \setminus A_{n-1})$,
    і цей ряд є збіжним. Запишемо значення його часткової суми:

    \noindent $S_n = \P(A_1) + \sum\limits_{k=2}^{n} \P(A_{k} \setminus A_{k-1}) = \P(A_1) + \P(A_2) - \P(A_1) + \P(A_3) - \P(A_2) + ... + \P(A_n) - \P(A_{n-1}) = \P(A_n)$.
    Отже, $\P\left(\bigcup\limits_{n=1}^{\infty} A_n\right) = \lim\limits_{n\rightarrow \infty} S_n = \lim\limits_{n\rightarrow \infty} \P(A_n)$.
\end{proof}
\begin{remark}
    Застосовуючи природне позначення $\bigcup\limits_{n=1}^{\infty} A_k = \lim\limits_{n\rightarrow \infty} A_n$, твердження теореми \ref{th:1}
    можна записати як $\P\left( \lim\limits_{n\rightarrow \infty} A_n\right) = \lim\limits_{n\rightarrow \infty} \P(A_n)$, що пояснює назву теореми.
    Також, <<розширення>> подій $A_n$ до $A$ можна записати як $A_n \nearrow A$, тому твердження теореми можна ще записати як
    $\left(A_n \nearrow A\right) \Rightarrow \left(\P(A_n) \rightarrow \P(A)\right)$.
\end{remark}

\begin{theorem}\label{th:2}
    Нехай є монотонно спадна послідовність подій $A_1 \supset A_2 \supset ... \supset A_n ... \in \mathcal{F}$.
    Тоді $\P\left(\bigcap\limits_{n=1}^{\infty} A_n\right) = \lim\limits_{n\rightarrow \infty} \P(A_n)$.
\end{theorem}
\begin{proof}
    $\P\left(\bigcap\limits_{n=1}^{\infty} A_n\right) = 1 - \P\left(\bigcup\limits_{n=1}^{\infty} \overline{A_n}\right) \overset{\text{т. \refeq{th:1}}}{=} 1 -
    \lim\limits_{n\rightarrow \infty} \P(\overline{A_n}) = \lim\limits_{n\rightarrow \infty} (1-\P(\overline{A_n})) = \lim\limits_{n\rightarrow \infty} \P(A_n)$.
\end{proof}
\begin{remark}
    Аналогічно, застосовуючи позначення $\bigcap\limits_{n=1}^{\infty} A_k = \lim\limits_{n\rightarrow \infty} A_n$ та $A_n \searrow A$, твердження теореми
    \ref{th:2} можна записати як $\P\left( \lim\limits_{n\rightarrow \infty} A_n\right) = \lim\limits_{n\rightarrow \infty} \P(A_n)$ або 
    $\left(A_n \searrow A\right) \Rightarrow \left(\P(A_n) \rightarrow \P(A)\right)$.
\end{remark}

За допомогою теорем \ref{th:1} та \ref{th:2} можна довести, що замість аксіоми \textbf{P3} можна розглядати деяку іншу аксіому.
\begin{theorem}\index{аксіома!неперервності}
    Аксіома зліченної адитивності \textbf{P3} еквівалентна аксіомі неперервності
    \textbf{P4}: $$\forall n \in \mathbb{N}: B_n \in \mathcal{F}, B_1 \supset B_2 \supset ... \supset B_n \supset ..., \bigcap\limits_{n=1}^{\infty} B_n = \varnothing \Rightarrow \lim_{n\rightarrow \infty} \P(B_n) = 0$$
    \begin{proof}
        За теоремою \refeq{th:2} маємо наслідок \textbf{P3} $\Rightarrow$ \textbf{P4}.

        Доведемо \textbf{P4} $\Rightarrow$ \textbf{P3}. Для подій $A_1, A_2, ... , A_n, ... \in \mathcal{F}, A_i \cap A_j = \varnothing \text{ при } i \neq j$
        введемо події $B_n = \bigcup\limits_{k=n+1}^{\infty} A_k$. Для них виконується $B_1 \supset B_2 \supset ... \supset B_n \supset ...$ та $\bigcap\limits_{n=1}^{\infty} B_n = \varnothing$,
        тому з аксіоми \textbf{P4} $\lim\limits_{n\rightarrow \infty} \P(B_n) = 0$.

        З іншого боку, маємо таку рівність:
        $$\P\left(\bigcup\limits_{k=1}^{\infty} A_k\right) = \P\left(\bigcup\limits_{k=1}^{n} A_k\right) + \P\left(\bigcup\limits_{k=n+1}^{\infty} A_k\right) = \sum\limits_{k=1}^{n} \P(A_k) + \P(B_n)$$
        Перейшовши у правій частині до границі при $n \rightarrow \infty$, отримаємо $\P\left(\bigcup\limits_{k=1}^{\infty} A_k\right) = \sum\limits_{k=1}^{\infty} \P(A_k)$, 
        що є твердженням аксіоми зліченної адитивності.
    \end{proof}
\end{theorem}
